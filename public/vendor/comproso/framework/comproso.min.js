
var version="0.4.6";function sendRequest(requestDataType)
{if(requestDataType===undefined)
{requestDataType="json";}
if(requestDataType=="html")
{$('form.cpage').submit();}
if(requestDataType==="json")
{var noredirection=true;var request=$.ajax($('form.cpage').attr('action'),{dataType:requestDataType,data:$('form.cpage input, form.cpage select, form.cpage textarea').serialize(),cache:false,timeout:30000,method:"post",headers:{'X-CSRF-TOKEN':$('meta[name="csrf-token"]').attr('content')},beforeSend:function(){var ccusrnd=Date.now();$('form.cpage input[name="ccusr_nd"]').val(ccusrnd);},success:function(response){if(response.redirect===undefined)
{noredirection=true;$('form.cpage input[name="ccfg_tmlt"]').val(response.time_limit);$('form.cpage input[name="ccfg_tvl"]').val(response.interval);$('form.cpage input[name="ccusr_rnd"]').val(response.round);$('form.cpage input[name="ccusr_ctns"]').val(JSON.stringify([]));$.each(response.results,function(name,result){if(result.results.accessors!==undefined)
{element=$('body#comproso form.cpage *[name="'+result.name+'"]');$.each(result.results.accessors,function(index,accessor){if(element.attr("data-"+accessor)!==undefined)
{arr=element.data(accessor);arr.push(result.results[accessor]);element.data(accessor,arr);}
element.attr(accessor,result.results[accessor]);});element.triggerHandler("updated");}});$(document).triggerHandler('jsonResponse');}
else
{noredirection=false;if(typeof tInt!=='undefined')
{clearTimeout(tInt);}
sendRequest("html");}
$(document).triggerHandler('ajaxProceeded');},complete:function(){if(noredirection)
{$('.cnav .button').prop('disabled',false).removeClass('disabled');$('form.cpage input[name="ccusr_tstrt"]').val(Date.now());}},done:function(){$('form.cpage input[name="ccusr_rt"]').val((Date.now()-ccusrnd));},error:function(xhr,status,errorThrown){console.log("Error: "+errorThrown);console.log("Status: "+status);console.dir(xhr);document.write(xhr.responseText);}});}}
function storeProcessData(element){if((element===undefined)&&(!$(this).attr('name')))
return;actions=JSON.parse($('form.cpage input[name="ccusr_ctns"]').val());newactions={};if(element===undefined)
{newactions.item=$(this).attr('name');newactions.value=$(this).attr('value');}
else
{newactions.item="reset";newactions.value=true;}
newactions.tstmp=Date.now()-$('form.cpage input[name="ccusr_tstrt"]').val();actions.push(newactions);$('form.cpage input[name="ccusr_ctns"]').val(JSON.stringify(actions));}
$(document).on("jsonResponse",function(){if($('form.cpage .cnav').length===0)
{if($('form.cpage input[name="ccfg_tvl"]').val()>0)
{var tvlId=setTimeout(sendRequest,($('form.cpage input[name="ccfg_tvl"]').val()*1000));}}});$(document).on("ready",function(){$('form.cpage input[name="ccusr_tstrt"]').val(Date.now());if(typeof tInt!=='undefined')
{clearTimeout(tInt);}
if(($('form.cpage .cnav').length===0)&&($('form.cpage input[name="ccfg_tvl"]').val()>0))
{if($('form.cpage input[name="ccfg_tvl"]').val()>5)
{var tInt=setTimeout(sendRequest,($('form.cpage input[name="ccfg_tvl"]').val()*1000));}
else
{var tInt=setTimeout(sendRequest,5000);}}
$('.cnav .button:not(.inactive):not(.disabled)').click(function(){if($(this).hasClass('rst'))
{$('form.cpage').trigger('reset');}
else
{$('.cnav .button').prop('disabled',true).addClass('disabled');if((typeof request==='undefined')||(request.readyState===0)||(request.readyState>4))
{if($(this).hasClass('bwd'))
{$('form.cpage input[name="cctrl_prvs"]').val(1);}
else
{$('form.cpage input[name="cctrl_prvs"]').val(0);}
$('form.cpage input[name="ccusr_nd"]').val(Date.now());sendRequest();}}});$('form.cpage *:not(.notrace) input[name^="item"]:not(.notrace)').change(storeProcessData());});